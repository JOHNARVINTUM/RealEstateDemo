{% extends "base.html" %}
{% block title %}My Requests - RealEstate360+{% endblock %}

{% block content %}
<div class="min-h-screen flex bg-gray-50">

  <!-- Sidebar -->
  <aside class="w-72 bg-emerald-900 text-white flex flex-col">
    <div class="px-6 py-6 border-b border-emerald-800">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-lg bg-emerald-800 flex items-center justify-center font-bold">
          RE
        </div>
        <div>
          <div class="text-lg font-bold">RealEstate360+</div>
          <div class="text-xs text-emerald-200">Tenant Portal</div>
        </div>
      </div>
    </div>

    <nav class="px-4 py-6 space-y-2 flex-1">
      <a href="{% url 'tenant_dashboard' %}"
         class="block px-4 py-3 rounded-lg hover:bg-emerald-800/40 transition">
        Dashboard
      </a>

       <a href="{% url 'tenant_billing' %}" class="block px-4 py-3 rounded-lg hover:bg-emerald-800/40 transition">
      View Billing
     </a>
      <a href="{% url 'tenant_pay_advance' %}"
         class="block px-4 py-3 rounded-lg hover:bg-emerald-800/40 transition">
        Make Payment
      </a>

      <a href="{% url 'maintenance_list' %}"
         class="block px-4 py-3 rounded-lg bg-emerald-800/60 hover:bg-emerald-800 transition font-semibold">
        Maintenance Requests
      </a>

      <a href="{% url 'report_issue' %}"
         class="block px-4 py-3 rounded-lg hover:bg-emerald-800/40 transition">
        Report Issue
      </a>

       
    </a>
    </nav>

    <div class="px-4 py-6 border-t border-emerald-800">
      <form method="post" action="{% url 'logout' %}">
        {% csrf_token %}
        <button type="submit"
                class="w-full text-left px-4 py-3 rounded-lg hover:bg-emerald-800/40 transition">
          Logout
        </button>
      </form>
    </div>
  </aside>

  <!-- Main Content -->
  <main class="flex-1 px-8 py-8">
    <div class="flex items-center justify-between">
      <h1 class="text-3xl font-bold text-gray-900">My Maintenance Requests</h1>
      <a href="{% url 'report_issue' %}"
         class="bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition">
        + New Request
      </a>
    </div>

    <div class="mt-6 bg-white rounded-2xl shadow-sm border overflow-hidden">
      <table class="min-w-full">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-600">Date</th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-600">Category</th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-600">Title</th>
            <th class="px-4 py-3 text-left text-sm font-semibold text-gray-600">Status</th>
          </tr>
        </thead>

        <tbody class="divide-y">
          {% for r in requests %}
            <tr class="hover:bg-gray-50">
              <td class="px-4 py-3 text-sm">{{ r.created_at|date:"Y-m-d" }}</td>
              <td class="px-4 py-3 text-sm">{{ r.get_category_display }}</td>
              <td class="px-4 py-3 text-sm font-semibold">{{ r.title }}</td>
              <td class="px-4 py-3 text-sm">
                {% if r.status == "OPEN" %}
                  <span class="px-2 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800">OPEN</span>
                {% elif r.status == "IN_PROGRESS" %}
                  <span class="px-2 py-1 rounded-full text-xs font-semibold bg-blue-100 text-blue-800">IN PROGRESS</span>
                {% elif r.status == "RESOLVED" %}
                  <span class="px-2 py-1 rounded-full text-xs font-semibold bg-emerald-100 text-emerald-800">RESOLVED</span>
                {% else %}
                  <span class="px-2 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-800">CLOSED</span>
                {% endif %}
              </td>
            </tr>
          {% empty %}
            <tr>
              <td class="px-4 py-6 text-sm text-gray-500" colspan="4">
                No requests yet. Click “New Request” to report an issue.
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </main>

</div>
{% endblock %}
