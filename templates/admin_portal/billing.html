{% extends "admin_portal/base.html" %}
{% block title %}Billing{% endblock %}
{% block content %}
  <div class="page-header">
    <h1>Billing</h1>
    <p class="muted">Monthly bills overview</p>
  </div>

  <form class="toolbar" method="get">
    <input class="input" name="q" value="{{ q }}" placeholder="Search tenant email, unit, ref..." />
    <select class="input" name="status">
      <option value="">All</option>
      <option value="PAID" {% if status == "PAID" %}selected{% endif %}>PAID</option>
      <option value="UNPAID" {% if status == "UNPAID" %}selected{% endif %}>UNPAID</option>
    </select>
    <button class="btn" type="submit">Filter</button>
  </form>

  <div class="table-wrap">
    <table class="table">
      <thead>
        <tr>
          <th>Tenant</th>
          <th>Unit</th>
          <th>Month</th>
          <th>Due</th>
          <th>Total</th>
          <th>Status</th>
          <th>Paid At</th>
          <th>Ref</th>
        </tr>
      </thead>
      <tbody>
        {% for b in bills %}
          <tr>
            <td>{{ b.lease.tenant.email }}</td>
            <td>{{ b.lease.unit.number }}</td>
            <td>{{ b.billing_month }}</td>
            <td>{{ b.due_date }}</td>
            <td>â‚±{{ b.total_due|floatformat:0 }}</td>
            <td>{{ b.status }}</td>
            <td>{{ b.paid_at|default:"-" }}</td>
            <td>{{ b.payment_reference|default:"-" }}</td>
          </tr>
        {% empty %}
          <tr><td colspan="8" class="muted">No bills found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}